
  //////////////////////////////////////
  //
  // INDEX
  // =====
  // page
  // temp.tax
  // plugin.tx_browser_pi1



page {
  includeCSS {
    // add the quick shop default css
    quick_shop = EXT:quick_shop/res/templates/default.css
  }
}



temp.tax = CASE
temp.tax {
  key = ###TX_QUICKSHOP_PRODUCTS.TAX###
  # reduced tax
  1 = TEXT
  1.value = 7
  2 = TEXT
  2.value = 19
  stdWrap {
    noTrimWrap = |inkl. | % MwSt.|
  }
}

plugin.tx_browser_pi1 {
  
    // #53378, 131107, dwildt, 1-
  general_stdWrap >

  flexform {
    socialmedia {
      socialbookmarks {
        wraps {
          stdWrap_items.wrap = <div class="bookmark_items">|</div>
        }
      }
    }
  }
  displaySingle {
    seo {
      htmlHead {
      title = 1
        meta {
          description = 1
          keywords    = 1
        }
      }
    }
  }
  marker {
    my_caddybutton = COA
    my_caddybutton {
      10 = TEXT
      10 {
        data = LLL:EXT:quick_shop/locallang_db.xml:marker_my_caddylabel
        wrap = <button class="submit" name="submit" type="submit" value="|">
      }
      20 = TEXT
      20 {
        data        = LLL:EXT:quick_shop/locallang_db.xml:marker_my_caddylabel
        noTrimWrap  = || |
      }
      30 = IMAGE
      30 {
        file = {$plugin.caddy.html.color.icon.caddy}
        altText {
          data = LLL:EXT:quick_shop/locallang_db.xml:marker_my_caddyimgalt
        }
        titleText {
          data = LLL:EXT:quick_shop/locallang_db.xml:marker_my_caddyimgalt
        }
        params = class="linktocaddy"
      }
      40 = TEXT
      40 {
        value = </button>
      }
    }
    my_caddyurl = TEXT
    my_caddyurl {
      typolink {
        parameter = {$plugin.quick_shop.pages.caddy}
        returnLast = url
      }
    }
    my_shipping_note = TEXT
    my_shipping_note {
      value = shipping
      lang {
        de = Versand
      }
      typolink.parameter = {$plugin.quick_shop.pages.shipping}
      prepend = TEXT
      prepend {
        value = excl.
        lang {
          de = zzgl.
        }
      }
    }
  }
  views {
    list {
      1 = Quick Shop
      1 {
        name = Quick Shop
        select (
          tx_quickshop_products.title,
          tx_quickshop_products.sku,
          tx_quickshop_products.short,
          tx_quickshop_products.image,
          tx_quickshop_products.imageseo,
          tx_quickshop_products.tax,
          tx_quickshop_products.price,
          tx_quickshop_products.uid
        )
        orderBy = tx_quickshop_products.price DESC, tx_quickshop_products.title, tx_quickshop_categories.title
        csvLinkToSingleView = tx_quickshop_products.title          
        tx_quickshop_products {
            // tx_quickshop_products.title
          title = TEXT
          title {
            value = ###TX_QUICKSHOP_PRODUCTS.TITLE###
            wrap  = <h2 class="title">|</h2>
          }
            // tx_quickshop_products.short, detail
          short = COA
          short {
              // tx_quickshop_products.short
            10 = TEXT
            10 {
              value = ###TX_QUICKSHOP_PRODUCTS.SHORT###
            }
              // detail
            20 = TEXT
            20 {
              data = LLL:EXT:quick_shop/locallang_db.xml:linktosingleview
              typolink {
                parameter         = {$plugin.quick_shop.pages.shop} - linktosingle
                additionalParams  = &tx_browser_pi1[showUid]=###TX_QUICKSHOP_PRODUCTS.UID###
                useCacheHash = 1
                title {
                  data = LLL:EXT:quick_shop/locallang_db.xml:linktosingleview
                }
              }
              noTrimWrap = | ||
            }
            wrap = <h3 class="short">|</h3>
          }
          image = COA
          image {
              // Handle with an image at least
            10 = COA
            10 {
              if {
                  // If we have an image, tx_quickshop_products.image will render the description
                isTrue = ###TX_QUICKSHOP_PRODUCTS.IMAGE###
              }
              10 < tt_content.image.20
              10 {
                imgList.field >
                imgList   = ###TX_QUICKSHOP_PRODUCTS.IMAGE###
                imgPath   = uploads/tx_quickshop/
                imgStart  = 0
                imgMax    = 1
                1 {
                  file {
                    width.field >
                    width   = {$plugin.quick_shop.images.list.maxW}
                    height  = {$plugin.quick_shop.images.list.maxH}
                  }
                  titleText.field >
                  titleText       = ###TX_QUICKSHOP_PRODUCTS.IMAGESEO###
                  imageLinkWrap {
                    enable.field >
                    enable = 1
                    width   = 1000;
                    height  = 800m;
                    //JSwindow = 0
                  }
                }
                layout {
                  key.field >
                    // above-left
                  key = 2
                  2.value = <div class="csc-textpic csc-textpic-left csc-textpic-above###CLASSES###">###IMAGES######TEXT###</div>
                }
                cols.field  >
                cols        = 1
                caption >
                stdWrap {
                  prefixComment >
                  wrap          = <div class="image">|</div>
                }
              }
            }
              // Handle without any image 
            20 < .10
            20 {
              if {
                isTrue  >
                isFalse = ###TX_QUICKSHOP_PRODUCTS.IMAGE###
              }
              10 {
                imgList = alternate_image_400x300.gif
                imgPath = EXT:quick_shop/res/images/
              }
            }
          }
          price = COA
          price {
            wrap = |&nbsp;{$plugin.quick_shop.base.currencySymbol}
            10 = USER
            10.userFunc = tx_browser_typoscript->numberFormat
            10.userFunc {
              number = TEXT
              number {
                value = ###TX_QUICKSHOP_PRODUCTS.PRICE###
              }
              decimal   = 2
              dec_point = {$plugin.quick_shop.base.dec_point}
              thousands_sep = {$plugin.quick_shop.base.thousands_sep}
            }
          }
          tax < temp.tax
          tax.stdWrap.noTrimWrap = |inkl. | % MwSt.|
        }
        filter {
          tx_quickshop_categories {
              // #42072, dwildt, 1-, 1+
            //title < plugin.tx_browser_pi1.displayList.master_templates.selectbox
            title < plugin.tx_browser_pi1.displayList.master_templates.treeview
            title {
              condition >
              condition = TEXT
              condition {
                value = {$plugin.quick_shop.filter.category}
              }
              count_hits = 0
              treeview {
                enabled {
                  value = 1
                }
              }
              first_item {
                cObject {
                  20 {
                    data = LLL:EXT:quick_shop/locallang_db.xml:filter_phrase.category
                  }
                }
              }
                // #43641, dwildt, 1-, 1+
              //wrap = <span class="selectbox">|</span>
              wrap = <div class="category_menu category_menu_treeview caddy">|</div>
            }
          }
          tx_quickshop_dimension {
            title < plugin.tx_browser_pi1.displayList.master_templates.selectbox
            title {
              condition >
              condition = TEXT
              condition {
                value = {$plugin.quick_shop.filter.dimension}
              }
              //count_hits = 0
              first_item {
                cObject {
                  20 {
                    data = LLL:EXT:quick_shop/locallang_db.xml:filter_phrase.dimension
                  }
                }
              }
              wrap = <span class="selectbox dimension selectbox-dimension">|</span>
            }
          }
          tx_quickshop_material {
            title < plugin.tx_browser_pi1.displayList.master_templates.selectbox
            title {
              condition >
              condition = TEXT
              condition {
                value = {$plugin.quick_shop.filter.material}
              }
              //count_hits = 0
              first_item {
                cObject {
                  20 {
                    data = LLL:EXT:quick_shop/locallang_db.xml:filter_phrase.material
                  }
                }
              }
              wrap = <span class="selectbox material selectbox-material">|</span>
            }
          }
        }
          // marker and subparts will replaced in the HTML template before data handling
          // #47068, 130409, dwildt
        htmlSnippets =
        htmlSnippets {
          marker {
            filter = TEXT
            filter {
              value (
              <div class="filter">
                ###TX_QUICKSHOP_CATEGORIES.TITLE###
                ###TX_QUICKSHOP_DIMENSION.TITLE###
                ###TX_QUICKSHOP_MATERIAL.TITLE###
              </div>
)
            }
          }
          subparts {
            listview = TEXT
            listview {
              value (
                <div id="c###TT_CONTENT.UID###-listview-###MODE###" class="###VIEW###view ###VIEW###view-content ###VIEW###view-###MODE### ###VIEW###view-content-###MODE###">
                  <!-- ###LISTBODY### begin --><!-- ###LISTBODYITEM### begin -->
                  <div class="charges">
                    <div class="price">
                      ###TX_QUICKSHOP_PRODUCTS.PRICE###
                    </div>
                    <div class="tax_shipping">
                      ###TX_QUICKSHOP_PRODUCTS.TAX### ###MY_SHIPPING_NOTE###
                    </div>
                    <form class="caddy" name="caddy" action="###MY_CADDYURL###" method="post">
                      <fieldset id="add-to-cart">
                        <input type="hidden" name="tx_browser_pi1[showUid]" value="###TX_QUICKSHOP_PRODUCTS.UID###" />
                        <select name="tx_quickshop_qty">
                          <option>1</option>
                          <option>2</option>
                          <option>3</option>
                          <option>4</option>
                          <option>5</option>
                          <option>6</option>
                          <option>7</option>
                          <option>8</option>
                          <option>9</option>
                          <option>10</option>
                          <option>11</option>
                          <option>12</option>
                          <option>13</option>
                          <option>14</option>
                          <option>15</option>
                          <option>16</option>
                          <option>17</option>
                          <option>18</option>
                          <option>19</option>
                          <option>20</option>
                        </select>
                        ###MY_CADDYBUTTON###
                      </fieldset>
                    </form>
                  </div>
                  ###SOCIALMEDIA_BOOKMARKS###
                  ###TX_QUICKSHOP_PRODUCTS.IMAGE###
                  ###TX_QUICKSHOP_PRODUCTS.TITLE###
                  ###TX_QUICKSHOP_PRODUCTS.SHORT###
                  <div style="clear:both"></div>
                  <!-- ###LISTBODYITEM### end --><!-- ###LISTBODY### end -->
                </div> <!-- /listview -->
)
            }
          }
        }
      }
    }
    single {
      1 = Quick Shop
      1 {
        displaySingle < plugin.tx_browser_pi1.displaySingle
        displaySingle {
          image {
              // We don't want an alternate image
            file >
          }
        }
        select (
          tx_quickshop_products.title,
          tx_quickshop_products.sku,
          tx_quickshop_products.description,

          tx_quickshop_products.datasheet,
          tx_quickshop_products.cols,
          tx_quickshop_products.pi_flexform,

          tx_quickshop_products.image,
          tx_quickshop_products.imageseo,
          tx_quickshop_products.imagewidth,
          tx_quickshop_products.imageheight,
          tx_quickshop_products.imageorient,
          tx_quickshop_products.imagecols,
          tx_quickshop_products.imageborder,
          tx_quickshop_products.image_frames,
          tx_quickshop_products.image_link,
          tx_quickshop_products.image_zoom,
          tx_quickshop_products.image_noRows,
          tx_quickshop_products.image_effects,
          tx_quickshop_products.image_compression,

          tx_quickshop_products.caption,
          tx_quickshop_products.caption_position,
          tx_quickshop_products.caption,
          tx_quickshop_products.tax,
          tx_quickshop_products.price,

          tx_quickshop_products.seo_description,
          tx_quickshop_products.seo_keywords,

          tx_quickshop_categories.title
        )
        tx_quickshop_products {
            // title
          title = TEXT
          title {
            value = ###TX_QUICKSHOP_PRODUCTS.TITLE###
            wrap  = <h1>|</h1>
          }
            // Handle with an image
          image = COA
          image {
              // Handle with an image at least
            if {
                // If we have an image, tx_quickshop_products.image will render the description
              isTrue = ###TX_QUICKSHOP_PRODUCTS.IMAGE###
            }
              // tt_content.image.20
            10 < tt_content.image.20
            10 {
              imgList.field >
              imgList = ###TX_QUICKSHOP_PRODUCTS.IMAGE###
              imgPath = uploads/tx_quickshop/
              1 {
                file {
                  width.field >
                  width   = ###TX_QUICKSHOP_PRODUCTS.IMAGEWIDTH###
                }
                titleText.field               >
                titleText                     = ###TX_QUICKSHOP_PRODUCTS.IMAGESEO###
                imageLinkWrap {
                  ifEmpty {
                    typolink.parameter.field  >
                    typolink.parameter        = ###TX_QUICKSHOP_PRODUCTS.IMAGE_LINK###
                  }
                  typolink.parameter.field    >
                  typolink.parameter          = ###TX_QUICKSHOP_PRODUCTS.IMAGE_LINK###
                  enable.field                >
                  enable                      = ###TX_QUICKSHOP_PRODUCTS.IMAGE_ZOOM###
                  width                       = 1000;
                  height                      = 800m;
                  //JSwindow = 0
                }
              }
              textPos.field           >
              textPos                 = ###TX_QUICKSHOP_PRODUCTS.IMAGEORIENT###
              equalH.field            >
              equalH                  = ###TX_QUICKSHOP_PRODUCTS.IMAGEHEIGHT###
              image_compression.field >
              image_compression       = ###TX_QUICKSHOP_PRODUCTS.IMAGE_COMPRESSION###
              image_effects.field     >
              image_effects           = ###TX_QUICKSHOP_PRODUCTS.IMAGE_EFFECTS###
              noRows.field            >
              noRows                  = ###TX_QUICKSHOP_PRODUCTS.IMAGE_NOROWS###
              cols.field              >
              cols                    = ###TX_QUICKSHOP_PRODUCTS.IMAGECOLS###
              border.field            >
              border                  = ###TX_QUICKSHOP_PRODUCTS.IMAGEBORDER###
              caption.1.field         >
              caption.1.value         = ###TX_QUICKSHOP_PRODUCTS.CAPTION###
              captionAlign.field      >
              captionAlign            = ###TX_QUICKSHOP_PRODUCTS.CAPTION_POSITION###
              layout.key.field        >
              layout.key              = ###TX_QUICKSHOP_PRODUCTS.IMAGEORIENT###
              stdWrap {
                prefixComment >
                wrap          = <div class="image">|</div>
              }
                // description, sku
              text {
                  // description, datasheet, sku
                20 = COA
                20 {
                    // description
                  10 = TEXT
                  10 {
                    parseFunc < lib.parseFunc_RTE
                    value     = ###TX_QUICKSHOP_PRODUCTS.DESCRIPTION###
                  }
                    // datasheet
                  20 < tt_content.table.20
                  20 {
                    userFunc = tx_browser_cssstyledcontent->render_table
                    userFunc {
                        // add the value of a field to another field in cObj->data
                      cObjDataFieldWrapper =
                      cObjDataFieldWrapper {
                        cols            = tx_quickshop_products.cols
                        pi_flexform     = tx_quickshop_products.pi_flexform
                        uid             = tx_quickshop_products.uid
                      }
                    }
                    field = tx_quickshop_products.datasheet
                    stdWrap {
                        // With a prefix comment there won't be any output!
                      prefixComment >
                    }
                  }
                    // sku
                  30 = TEXT
                  30 {
                    data        = LLL:EXT:quick_shop/locallang_db.xml:tx_quickshop_products.sku
                    noTrimWrap  = |<p>|: ###TX_QUICKSHOP_PRODUCTS.SKU###</p>|
                  }
                  wrap = <div class="csc-textpic-text"> | </div>
                }
              }
            }
          }
            // Handle without any image 
          description < .image
          description {
            if {
              isTrue >
              isFalse = ###TX_QUICKSHOP_PRODUCTS.IMAGE###
            }
            10 {
              imgList = alternate_image_400x300.gif
              imgPath = EXT:quick_shop/res/images/
            }
          }
            // price
          price = COA
          price {
            wrap = |&nbsp;{$plugin.quick_shop.base.currencySymbol}
            10 = USER
            10.userFunc = tx_browser_typoscript->numberFormat
            10.userFunc {
              number = TEXT
              number {
                value = ###TX_QUICKSHOP_PRODUCTS.PRICE###
              }
              decimal   = 2
              dec_point = {$plugin.quick_shop.base.dec_point}
              thousands_sep = {$plugin.quick_shop.base.thousands_sep}
            }
          }
            // tax
          tax < temp.tax
          tax.stdWrap.noTrimWrap = |inkl. | % MwSt.|
        }
          // marker and subparts will replaced in the HTML template before data handling
          // #47068, 130409, dwildt
        htmlSnippets =
        htmlSnippets {
          subparts {
            singleview = TEXT
            singleview {
              value (
<!-- ###AREA_FOR_AJAX_LIST_01### begin -->
        <div id="c###TT_CONTENT.UID###-singleview-###MODE###" class="singleview singleview-###MODE###">
          ###RECORD_BROWSER###
          <!-- ###SINGLEBODY### begin --><!-- ###SINGLEBODYROW### begin -->
          <div class="charges">
            <div class="price">
              ###TX_QUICKSHOP_PRODUCTS.PRICE###
            </div>
            <div class="tax_shipping">
              ###TX_QUICKSHOP_PRODUCTS.TAX### ###MY_SHIPPING_NOTE###
            </div>
          </div>
          ###SOCIALMEDIA_BOOKMARKS###
          ###TX_QUICKSHOP_PRODUCTS.TITLE###
          ###TX_QUICKSHOP_PRODUCTS.IMAGE###
          ###TX_QUICKSHOP_PRODUCTS.DESCRIPTION###
          <div style="clear:both"></div>
          <form class="caddy" name="caddy" action="###MY_CADDYURL###" method="post">
            <fieldset id="add-to-cart">
              <input type="hidden" name="tx_browser_pi1[showUid]" value="###SHOWUID###" />
              <select name="tx_quickshop_qty">
                <option>1</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5</option>
                <option>6</option>
                <option>7</option>
                <option>8</option>
                <option>9</option>
                <option>10</option>
                <option>11</option>
                <option>12</option>
                <option>13</option>
                <option>14</option>
                <option>15</option>
                <option>16</option>
                <option>17</option>
                <option>18</option>
                <option>19</option>
                <option>20</option>
              </select>
              ###MY_CADDYBUTTON###
            </fieldset>
          </form>
          <!-- ###SINGLEBODYROW### end --><!-- ###SINGLEBODY### end -->
<!-- ###AREA_FOR_AJAX_LIST_01### end -->
            <!-- ###BACKBUTTON### begin -->
            <p class="backbutton">
              ###BUTTON###
            </p>
          <!-- ###BACKBUTTON### end -->
<!-- ###AREA_FOR_AJAX_LIST_02### begin -->
        </div>
<!-- ###AREA_FOR_AJAX_LIST_02### end -->
)
            }
          }
        }
      }
    }
  }

  _LOCAL_LANG {
    default {
      list_mode_1_summary     = TYPO3 Quick Shop: Items
      single_mode_1_titleTag  = ###TX_QUICKSHOP_PRODUCTS.SEO_DESCRIPTION###
      single_mode_1_keywords  = Item, ###TX_QUICKSHOP_PRODUCTS.TITLE###, ###TX_QUICKSHOP_PRODUCTS.SEO_KEYWORDS###
      single_mode_1_summary   = ###TX_QUICKSHOP_PRODUCTS.SEO_DESCRIPTION###
    }
    de {
      list_mode_1_summary     = TYPO3 Quick Shop: Artikel
      single_mode_1_titleTag  = ###TX_QUICKSHOP_PRODUCTS.SEO_DESCRIPTION###
      single_mode_1_keywords  = Artikel, ###TX_QUICKSHOP_PRODUCTS.TITLE###, ###TX_QUICKSHOP_PRODUCTS.SEO_KEYWORDS###
      single_mode_1_summary   = ###TX_QUICKSHOP_PRODUCTS.SEO_DESCRIPTION###
    }
  }
}